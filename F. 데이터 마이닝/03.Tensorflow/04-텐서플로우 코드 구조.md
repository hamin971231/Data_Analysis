# 텐서플로우 코드 구조

💡 항상 이 절차를 염두하고 코딩하세요.


![res/code.png](res/code.png)

## #1 패키지 준비하기

- 구현에 필요한 패키들을 import 한다.
- 사전에 pip 명령어를 통해 설치가 되어 있어야 한다.
- 패키지를 import 하는 코드는 구현 중간에 명시 해도 상관 없지만 코드 최 상단에서 미리 준비해 두는 것이 전반적인 코드 가독성을 좋게 한다.

## #2 데이터셋 준비하기 

- 준비한 데이터셋을 로드한다.
- 데이터는 텐서 형태로 구성된다.
- 엑셀, CSV, OpenAPI나 크롤링을 통해 수집한 결과, 데이터베이스에서 가져온 형태 등 데이터 셋을 준비하는데 정해진 방법은 없다.

## #3 데이터 전처리 

- 결측치와 이상치 등을 확인하고 변환할 데이터가 있다면 처리한다.
- 범주형 데이터가 문자열로 되어있다면 숫자로 변환해 준다.

## #4 탐색적 데이터 분석 

- 데이터의 구조와 분포를 확인하기 위한 절차를 진행한다.
- 이 단계에서 각종 시각화 결과물을 생성하고 머신러닝에게 수행시킬 학습의 방향을 결정하게 된다.

## #5 데이터셋 분할하기 

- 완전한 형태의 데이터셋이고 수행해야 하는 학습 유형이 지도학습이라면 독립변수와 종속변수를 분리한다.
- `sklearn.model_selection` 패키지의 `train_test_split()` 함수를 사용하여 준비된 데이터를 훈련용 데이터와 테스트용(검증용 데이터로 분할한다.

```python
train_x, test_x, train_y, test_y = train_test_split(x_data, y_data, test_size=테스트용데이터의_비율(실수), random_state=랜덤시드)
```

- 일반적으로 `7:3` 비율로 나눈다.
- train_x : 훈련(=학습)용 **독립변수**
- train_y : 훈련(=학습)용 데이터에 대한 **종속변수**
- test_x : 검증용 **독립변수**
- test_y: 검증용 데이터에 대한 **종속변수**
- 분할된 변수중 연속형 자료(등간척도, 비율척도)에 대해서 필요하다면 정규화나 표준화를 수행한다.

## #6 모델 개발 ⭐⭐⭐⭐⭐ 

- `tensorflow.keras.models` 패키지의 `Sequential` 클래스에 대한 `model`객체를 생성한다.
- 이 객체의 `add()` 메서드를 통해 신경망층(=Dense층)을 쌓는다.
- 첫 번째 층을 쌓을 때 **활성화 함수**를 지정해야 한다.
- **잘 알려진 분석 모델 유형에 대해서는 이미 유형별로 정해져 있음** → 단순 암기
- 학습 성능을 향상시키고 과적합을 방지하기 위해 드롭아웃(Dropout)을 적용할 수 있다. (추후 다룸)
- 층을 다 쌓은 후에는 `model`객체의 `summary()` 함수를 사용하여 요약 정보를 확인할 수 있다.
- `model`객체의 `compile()` 함수를 사용하여 구성한 모델을 적용한다.
- `model`객체의 `compile()` 함수를 사용할 때 적절한 **옵티마이저**와 **손실함수**를 지정해야 한다.
- **잘 알려진 분석 모델 유형에 대해서는 이미 유형별로 정해져 있음** → 단순 암기
- 학습 성능을 향상시키기 위한 콜백 함수들을 지정할 수 있다.
- `model` 객체의 `fit()` 함수를 사용하여 학습을 진행한다.

```python
hist = model.fit(훈련용_독립변수, 훈련용_종속변수, epochs=15, validation_data=(검증용_독립변수, 검증용_종속변수), callbacks=[])
hist.history.keys()
```

- 데이터가 크고, 모델이 복잡한 경우 매우 오래 걸린다.
- 학습 결과로 반환받은 객체의 history 정보를 확인하면 학습 결과를 검토할 수 있는 항목을 확인할 수 있다.
- 에폭(`epochs`)는 수행할 총 훈련주기이다.
예를 들어 5만건의 데이터를 학습한다고 했을 때 이 데이터셋의 모든 케이스를 1회 확인하면 1에폭이다.
15에폭은 5만건의 데이터를 15회 검토했다는 것을 의미한다.

## #7 학습 결과 평가하기 

- `hist.history` 객체에 포함된 학습 과정에 대한 데이터를 시각화 하여 학습 과정을 확인할 수 있다.
- `model` 객체의 `evaluate()` 함수를 사용하여 성능을 확인할 수 있다.
- `model` 객체의 `predict()` 함수에 검증용 데이터 셋을 학습된 모델에 적용하여 종속변수에 대한 예측치를 산정한다.
- 실제 종속변수값과 비교하여 정확도를 확인한다.

## #8 학습 결과 적용하기 

- 완성된 모델에 임의의 데이터를 적용하여 머신러닝에 의한 예측 결과를 만들어낼 수 있다.